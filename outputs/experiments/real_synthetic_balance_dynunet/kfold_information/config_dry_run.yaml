experiment:
  name: seg_dynunet
  output_dir: outputs/experiments/real_synthetic_balance_dynunet
  seed: 42
data:
  real:
    enabled: true
    cache_dir: /media/mpascual/Sandisk2TB/research/epilepsy/data/slice_cache
    train_csv: train.csv
    val_csv: val.csv
    test_csv: test.csv
  synthetic:
    enabled: true
    samples_dir: /media/mpascual/Sandisk2TB/research/epilepsy/results/replicas_jsddpm_sinus_kendall_weighted_anatomicalprior/replicas
    replicas:
    - replica_019.npz
    - replica_018.npz
    merging_strategy: balance
  mask:
    convert_range: true
    binarize_threshold: 0.0
  image:
    check_range: true
k_fold:
  n_folds: 5
  split_level: subject
  exclude_test: true
  stratify_by: has_lesion_subject
  seed: 42
  folds_to_run: null
model:
  name: unet
  spatial_dims: 2
  in_channels: 1
  out_channels: 1
  kernel_size:
  - 3
  - 3
  - 3
  - 3
  strides:
  - 1
  - 2
  - 2
  - 2
  upsample_kernel_size:
  - 2
  - 2
  - 2
  filters:
  - 32
  - 64
  - 128
  - 256
  dropout: 0.1
  norm_name: instance
  act_name: leakyrelu
  deep_supervision: false
  deep_supr_num: 1
  res_block: true
  trans_bias: false
training:
  batch_size: 32
  num_workers: 0
  pin_memory: true
  class_balancing:
    enabled: false
    method: weighted_sampler
    lesion_weight: 5.0
  optimizer:
    type: AdamW
    lr: 0.0001
    weight_decay: 0.0001
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
  lr_scheduler:
    type: CosineAnnealingLR
    T_max: null
    eta_min: 1.0e-06
  max_epochs: 100
  max_steps: null
  precision: 16-mixed
  gradient_clip_val: 1.0
  gradient_clip_algorithm: norm
  accumulate_grad_batches: 1
  val_check_interval: 1.0
  check_val_every_n_epoch: 1
  early_stopping:
    enabled: true
    monitor: val/dice
    patience: 20
    mode: max
loss:
  type: DiceCELoss
  include_background: false
  to_onehot_y: false
  sigmoid: true
  softmax: false
  squared_pred: false
  jaccard: false
  reduction: mean
  lambda_dice: 1.0
  lambda_ce: 1.0
metrics:
  dice:
    include_background: false
    reduction: mean_batch
    get_not_nans: false
  hd95:
    percentile: 95
    spacing:
    - 1.875
    - 1.875
    handle_empty: 'nan'
  compute_iou: true
augmentation:
  enabled: false
  random_flip:
    enabled: true
    prob: 0.5
    spatial_axis:
    - 0
    - 1
  random_rotate:
    enabled: true
    prob: 0.5
    range_x: 0.26
    range_y: 0.26
    mode: bilinear
    padding_mode: zeros
  random_scale:
    enabled: true
    prob: 0.3
    scale_range:
    - 0.9
    - 1.1
  random_shift:
    enabled: false
    prob: 0.3
    shift_range:
    - 0.1
    - 0.1
  random_gamma:
    enabled: true
    prob: 0.3
    gamma_range:
    - 0.8
    - 1.2
  random_gaussian_noise:
    enabled: true
    prob: 0.2
    mean: 0.0
    std: 0.05
  random_gaussian_smooth:
    enabled: true
    prob: 0.2
    sigma_range:
    - 0.5
    - 1.0
logging:
  log_every_n_steps: 50
  wandb:
    enabled: true
    project: epilepsy-segmentation
    entity: mario-pg02-icai
    offline: true
    tags:
    - segmentation
    - k-fold
    group: null
    job_type: null
  csv:
    enabled: true
    per_fold: true
    aggregate: true
  checkpointing:
    save_top_k: 3
    monitor: val/dice
    mode: max
    save_last: true
    every_n_epochs: 1
    filename: seg-{epoch:04d}-{val_dice:.4f}
visualization:
  enabled: true
  every_n_epochs: 5
  n_samples: 4
  selection_strategy: mixed
  overlay:
    enabled: true
    alpha: 0.5
    pred_color:
    - 255
    - 0
    - 0
    gt_color:
    - 0
    - 255
    - 0
  save_png: true
  log_to_wandb: true
